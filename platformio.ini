[platformio]
default_envs = esp32s3-ospi

[env]
platform = espressif32@6.7.0
framework = arduino
monitor_speed = 115200
monitor_port = /dev/cu.usbmodem1101
src_dir = firmware/src
src_filter = +<*> -<build/>
include_dir = firmware/include

; Default build flags
; Override DEBUG_LEVEL: pio run -b esp32s3-ospi -DDEBUG=1
build_flags =
  -DDEBUG=0

; Optional: HALF_STEP support
; Uncomment to enable: pio run -b esp32s3-ospi -DHALF_STEP
; -DHALF_STEP

; All libraries with pinned versions from sketch.yaml
lib_deps =
  PU2CLR SI4735@2.1.8
  TFT_eSPI@2.5.43
  Async TCP@3.4.7
  ESP Async WebServer@3.7.10
  NTPClient@3.2.1
  ESP32-targz@1.3.1
  TinyCBOR@0.5.3002

; Common board settings
board_build.partitions = firmware/partitions.csv
board_build.flash_size = 8MB
board_build.flash_mode = qio
board_build.f_cpu = 80000000L
board_build.f_flash = 80000000L

; USB settings for CDC on boot
board_build.arduino.usb_mode = 1
board_build.arduino.usb_on_boot = 1

; ESP32-S3 with OPI PSRAM (default profile)
[env:esp32s3-ospi]
board = esp32-s3-devkitc-1
board_build.psram = opi
build_flags =
  ${env.build_flags}
  -DBOARD_HAS_PSRAM

; ESP32-S3 with QSPI PSRAM (alternate profile)
[env:esp32s3-qspi]
board = esp32-s3-devkitc-1
board_build.psram = enabled
build_flags =
  ${env.build_flags}
  -DBOARD_HAS_PSRAM
